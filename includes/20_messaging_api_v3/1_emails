<h2 id="send-e-mails"><a name="v3-emails-create"></a> Send e-mails</h2>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://bpc-api.boostcom.no/v3/infinity-mall/emails"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{ 
      "emails": {
          "id": "email_1", 
          "content": "Hello",
          "subject": "from api", 
          "from_name":"Boost",
          "from_email":"noreply@boost.no",
          "members_ids": [4175287, 123], 
        }
      }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"email_1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4175287</span><span class="p">,</span><span class="w">
      </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"email_1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
      </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member_not_found"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<blockquote>
<p>When payload is invalid (422), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid parameters"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"emails"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"members_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"size must be within 1 - 100"</span><span class="w">
            </span><span class="p">],</span><span class="w"> 
            </span><span class="s2">"from_email"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"is in invalid format"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/emails</code></p>

<p>Sends Emails (100 max) to target members.</p>

<p>Not all target members may be eligible for receiving an Email, so for every recipient in every notification 
a feedback is returned - see an example on the right.</p>

<p>Please note that successful feedback does not mean that message has been sent right away.
Messages are being sent asynchronously. Also, it cannot be guaranteed that the message will be delivered to user.</p>

<p>In future, a feature for checking messages delivery statuses will be added.</p>

<h4 id="messages-post-parameters-json-array">Messages POST Parameters (JSON array)</h4>

<p>The expected payload consists of <code class="prettyprint">emails</code> object which has an hash of objects with following attributes:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id *</td>
<td>string</td>
<td>n/a</td>
<td>ID of message. It&rsquo;s value is up to you, but we suggest to make it unique so the messages may be distinguished</td>
</tr>
<tr>
<td>members_ids *</td>
<td>int[]</td>
<td>n/a</td>
<td>IDs of members the message should be sent to</td>
</tr>
<tr>
<td>content *</td>
<td>string</td>
<td>n/a</td>
<td>The message content</td>
</tr>
<tr>
<td>subject*</td>
<td>string</td>
<td>n/a</td>
<td><em>Subject</em> field.</td>
</tr>
<tr>
<td>from_name</td>
<td>string</td>
<td>Loyalty Club settings wil be applied.</td>
<td><em>From</em> field.</td>
</tr>
<tr>
<td>from_email</td>
<td>string</td>
<td>Loyalty Club settings wil be applied.</td>
<td><em>Sender</em> field. Must be a valid (and verified - contact support@boostcom.no in case you don&rsquo;t have any verified domain) email address.</td>
</tr>
<tr>
<td>ignore_consents</td>
<td>bool</td>
<td>false</td>
<td>Should member consents be ignored?</td>
</tr>
<tr>
<td>ignore_email_verification_status</td>
<td>bool</td>
<td>false</td>
<td>Should member Email verification status be ignored?</td>
</tr>
</tbody></table>

<p>* required</p>

<h4 id="feedback-statuses">Feedback statuses</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ok</td>
<td>Message has been accepted for sending</td>
</tr>
<tr>
<td>member_not_found</td>
<td>Message with given ID does not exist</td>
</tr>
<tr>
<td>no_consent</td>
<td>Member has no <code class="prettyprint">email_marketing</code> consent - this may be ignored by enabling <code class="prettyprint">ignore_consents</code> option</td>
</tr>
<tr>
<td>email_missing</td>
<td>Member has no Email</td>
</tr>
<tr>
<td>email_unsubscribed</td>
<td>Members has unsubscribed from receiving emails</td>
</tr>
<tr>
<td>email_hard_bounced</td>
<td>Member&rsquo;s Email is marked as a hard bounced</td>
</tr>
<tr>
<td>email_unverified</td>
<td>Member&rsquo;s Email is not verified - this may be ignored by enabling <code class="prettyprint">ignore_email_verification_status</code> option</td>
</tr>
<tr>
<td>channel_disabled</td>
<td>Member has Email channel disabled</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Emails:Send</code> permit
</aside>
