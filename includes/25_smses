<h1 id="smses">SMSes</h1>

<h2 id="create"><a name="v3-smses-create"></a> Create</h2>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://bpc-api.boostcom.no/v3/infinity-mall/smses"</span> <span class="se">\</span>
    -H <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'X-Client-Authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'X-Product-Name: default'</span> <span class="se">\</span>
    -H <span class="s1">'X-User-Agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
      "messages": [
        { "id": "message:124", "member_id": 1, "content": "Hello" },
        { "id": "message:125", "member_id": 2, "content": "What is going on?", "sender": "Marvin Gaye" }
      ]
    }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"message:1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"message:2"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no_consent"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"message:3"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member_not_found"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">

</span></code></pre>
<blockquote>
<p>When payload is invalid (422), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid parameters"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"messages"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"0"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"it must have between 2-11 characters"</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"ignore_consents"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"must be boolean"</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/smses</code></p>

<p>Sends SMSes (100 max) to target members.</p>

<p>Not all target members may be eligible for receiving an SMS, so for every recipient in every notification 
a feedback is returned - see an example on the right.</p>

<p>Please note that successful feedback does not mean that message has been sent right away.
Messages are being sent asynchronously. Also, it cannot be guaranteed that the message will be delivered to user.</p>

<p>In future, a feature for checking messages delivery statuses will be added.</p>

<h3 id="messages-post-parameters-json-array">Messages POST Parameters (JSON array)</h3>

<p>The expected payload consists of <code class="prettyprint">messages</code> object which has array of objects with following attributes:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id *</td>
<td>string</td>
<td>n/a</td>
<td>ID of message. It&rsquo;s value is up to you, but we suggest to make it unique so the messages may be distinguished</td>
</tr>
<tr>
<td>member_id *</td>
<td>integer</td>
<td>n/a</td>
<td>IDs of member the message should be sent to</td>
</tr>
<tr>
<td>content *</td>
<td>string</td>
<td>n/a</td>
<td>The message content</td>
</tr>
<tr>
<td>sender</td>
<td>string</td>
<td>Loyalty Club settings will be applied.</td>
<td>Text which will be perceived by user as message sender (2-11 characters).</td>
</tr>
<tr>
<td>ignore_sending_window</td>
<td>bool</td>
<td>false</td>
<td>Should Loyalty Club sending window be ignored?</td>
</tr>
<tr>
<td>ignore_consents</td>
<td>bool</td>
<td>false</td>
<td>Should member consents be ignored?</td>
</tr>
<tr>
<td>ignore_msisdn_verification_status</td>
<td>bool</td>
<td>false</td>
<td>Should member MSISDN verification status be ignored?</td>
</tr>
<tr>
<td>shortening_enabled</td>
<td>bool</td>
<td>true</td>
<td>Should links in payload get shortened with Boostcom Shortener?</td>
</tr>
</tbody></table>

<p>* required</p>

<h3 id="feedback-statuses">Feedback statuses</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ok</td>
<td>Message has been accepted for sending</td>
</tr>
<tr>
<td>member_not_found</td>
<td>Message with given ID does not exist</td>
</tr>
<tr>
<td>no_consent</td>
<td>Member has no <code class="prettyprint">sms_marketing</code> consent - this may be ignored by enabling <code class="prettyprint">ignore_consents</code> option</td>
</tr>
<tr>
<td>msisdn_missing</td>
<td>Member has no MSISDN</td>
</tr>
<tr>
<td>msisdn_barred</td>
<td>Member&rsquo;s MSISDN is barred</td>
</tr>
<tr>
<td>msisdn_unverified</td>
<td>Member&rsquo;s MSISDN is not verified - this may be ignored by enabling <code class="prettyprint">ignore_msisdn_verification_status</code> option</td>
</tr>
<tr>
<td>channel_disabled</td>
<td>Member has SMS channel disabled</td>
</tr>
</tbody></table>

<h3 id="error-responses">Error responses</h3>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Smses:Send</code> permit
</aside>
