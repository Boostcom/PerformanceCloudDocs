<h2 id="documents"><a name="operations-admin-documents"></a> Documents</h2>

<h3 id="document-model"><a name="operations-admin-document-model"></a> Document model</h3>

<blockquote>
<p>Document example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
    </span><span class="s2">"confirmable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Fire instructions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"deadline_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-15T15:43:32.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"message_channel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sms"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first_reminder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"days_before_deadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="s2">"scheduled_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-10T08:00:00.000Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sent_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"second_reminder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"days_before_deadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"scheduled_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-13T08:00:00.000Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sent_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:12:46.435Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:12:46.435Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"recipients_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"recipients_confirmation_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>The document is an entity that has some files (with <code class="prettyprint">type: &quot;document&quot;</code> and Document&rsquo;s ID as <code class="prettyprint">identifier</code>) attached to it.</p>

<p>Upon creation, a notification containing a link to the document is sent via specified channel to given recipients (members of Tenant community).</p>

<p>When document is <code class="prettyprint">confirmable</code>, recipients may need to confirm it. In such case, a <code class="prettyprint">deadline_at</code> must be specified.
Also, it is possible to configure automated <a href="#operations-admin-document-reminder-model">reminder</a> messages that
are sent to recipients which didn&rsquo;t confirm the document.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>confirmable</td>
<td>boolean</td>
<td>no</td>
<td>Is document meant to be confirmed by recipients?</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>deadline_at</td>
<td>datetime</td>
<td>when not confirmable</td>
<td>Time until document is meant to be confirmed by recipients - only for <code class="prettyprint">confirmable</code> documents</td>
</tr>
<tr>
<td>message_channel</td>
<td>enum: <code class="prettyprint">[&#39;sms&#39;, &#39;email&#39;, &#39;push&#39;]</code></td>
<td>no</td>
<td>Channel that the document (and reminders) should be sent with</td>
</tr>
<tr>
<td>first_reminder</td>
<td><a href="#operations-admin-document-reminder-model">DocumentReminder</a></td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>second_reminder</td>
<td><a href="#operations-admin-document-reminder-model">DocumentReminder</a></td>
<td>yes</td>
<td>Can only be specified after the first reminder</td>
</tr>
<tr>
<td>created_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of creation</td>
</tr>
<tr>
<td>updated_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of last update</td>
</tr>
<tr>
<td>recipients_count</td>
<td>integer</td>
<td>no</td>
<td>Number of recipients</td>
</tr>
<tr>
<td>recipients_confirmation_status</td>
<td>enum: <code class="prettyprint">[&#39;all&#39;, &#39;some&#39;, &#39;none&#39;]</code></td>
<td>no</td>
<td>Describes how many recipients have confirmed the document</td>
</tr>
</tbody></table>

<h4 id="documentreminder-model"><a name="operations-admin-document-reminder-model"></a> DocumentReminder model</h4>

<blockquote>
<p>Document reminder example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"days_before_deadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"scheduled_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-13T08:00:00.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sent_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-13T08:00:01.540Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>days_before_deadline</td>
<td>integer</td>
<td>no</td>
<td>When the reminder should be sent - number of days before the specified deadline</td>
</tr>
<tr>
<td>scheduled_at</td>
<td>datetime</td>
<td>no</td>
<td>Actual calculated time for reminder sending - at 09:00 in the timezone specific for the Loyalty Club</td>
</tr>
<tr>
<td>sent_at</td>
<td>datetime</td>
<td>yes</td>
<td>When the reminder has been sent</td>
</tr>
</tbody></table>

<h3 id="documentrecipient-model"><a name="operations-admin-document-recipient-model"></a> DocumentRecipient model</h3>

<blockquote>
<p>DocumentRecipient example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">44</span><span class="p">,</span><span class="w">
    </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_seen_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:21:42.350Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:21:50.420Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T16:46:28.200Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T16:46:28.200Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>member_id</td>
<td>integer</td>
<td>no</td>
<td>ID of MPC member</td>
</tr>
<tr>
<td>last_seen_at</td>
<td>datetime</td>
<td>yes</td>
<td>Last time when the recipient retrieved the Document record</td>
</tr>
<tr>
<td>confirmed_at</td>
<td>datetime</td>
<td>yes</td>
<td>Time of confirmation</td>
</tr>
<tr>
<td>created_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of creation</td>
</tr>
<tr>
<td>updated_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of last update</td>
</tr>
</tbody></table>

<h3 id="list-documents"><a name="operations-admin-list-documents"></a> List Documents</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#operations-admin-document-model">documents</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"documents"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">documents</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/operations/documents</code></p>

<p>Returns list of <a href="#operations-admin-document-model">Documents</a>.  </p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>100</td>
<td>Number of results to be returned per request (100 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>confirmable</td>
<td>boolean</td>
<td>null</td>
<td>When true, returns only confirmable Documents - and vice versa</td>
</tr>
<tr>
<td>recipients_confirmation_status</td>
<td>enum: <code class="prettyprint">[&#39;all&#39;, &#39;some&#39;, &#39;none&#39;]</code></td>
<td>null</td>
<td>When present, returns only Documents having given <code class="prettyprint">recipients_confirmation_status</code></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:List</code> permit
</aside>

<h3 id="get-document"><a name="operations-admin-show-document"></a> Get Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/5"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#operations-admin-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/operations/documents/:id</code></p>

<p>Returns given <a href="#operations-admin-document-model">Document</a>.  </p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:Show</code> permit
</aside>

<h3 id="list-document-recipients"><a name="operations-admin-list-document-recipients"></a> List Document Recipients</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/15/recipients"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#operations-admin-document-recipient-model">document recipients</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document_recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">document</span><span class="w"> </span><span class="err">recipients</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"DocumentRecipient model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/operations/documents/:id/recipients</code></p>

<p>Returns list of <a href="#operations-admin-document-recipient-model">DocumentRecipients</a> that are assigned to given Document</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>100</td>
<td>Number of results to be returned per request (100 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>confirmed</td>
<td>boolean</td>
<td>null</td>
<td>When true, returns only recipients that confirmed - and vice versa</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Recipients:List</code> permit
</aside>

<h3 id="create-document"><a name="operations-admin-create-document"></a> Create Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
        "document": {
            "title": "My name",
            "message_channel": "sms",
            "confirmable": true,
            "deadline_at": "2020-12-15T15:43:32",
            "recipients": [14, 423],
            "first_reminder": { "days_before_deadline": 5 },
            "second_reminder": { "days_before_deadline": 2 }
        }
    }
  '</span>
</code></pre>
<blockquote>
<p>When successful, returns object containing created <a href="#operations-admin-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Document</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v1/operations/documents</code></p>

<p>Creates a new <a href="#operations-admin-document-model">Document</a> and sends it to given recipients.</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>document.title</strong></td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><strong>document.message_channel</strong></td>
<td>enum: <code class="prettyprint">[&#39;sms&#39;, &#39;email&#39;, &#39;push&#39;]</code></td>
<td>The channel for sending a notification and reminders</td>
</tr>
<tr>
<td><strong>document.recipients</strong></td>
<td>integer[]</td>
<td>IDs of members that should receive the document - max. 1000</td>
</tr>
<tr>
<td>document.confirmable</td>
<td>boolean</td>
<td>Is document meant to be confirmed by recipients? Default: <code class="prettyprint">false</code></td>
</tr>
</tbody></table>

<p>When the document is confirmable:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>document.deadline_at</strong></td>
<td>datetime</td>
<td>Date until the document should be confirmed</td>
</tr>
<tr>
<td>document.first_reminder.days_before_deadline</td>
<td>integer</td>
<td>Number of days before the deadline the first reminder should be sent</td>
</tr>
<tr>
<td>document.second_reminder.days_before_deadline</td>
<td>integer</td>
<td>Number of days before the deadline the second reminder should be sent</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>document</td>
<td>Document</td>
<td>See: <a href="#operations-admin-document-model">Document model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<h4 id="specific-validation-errors">Specific validation errors</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Error</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">document.second_reminder</code></td>
<td><code class="prettyprint">cannot_be_present_without_first_reminder</code></td>
</tr>
<tr>
<td><code class="prettyprint">document.second_reminder.days_before_deadline</code></td>
<td><code class="prettyprint">cannot_be_before_first_reminder</code></td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:Create</code> permit
</aside>

<h3 id="update-document"><a name="operations-admin-update-document"></a> Update Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/12"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
        "document": {
            "title": "My name",
            "deadline_at": "2020-12-15T15:43:32",
            "first_reminder": { "days_before_deadline": 5 },
            "second_reminder": { "days_before_deadline": 2 }
        }
    }
  '</span>
</code></pre>
<blockquote>
<p>When successful, returns object containing updated <a href="#operations-admin-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Document</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v1/operations/documents/:id</code></p>

<p>Updates the <a href="#operations-admin-document-model">Document</a>.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>document.title</strong></td>
<td>string</td>
<td></td>
</tr>
</tbody></table>

<p>When the document is confirmable:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>document.deadline_at</strong></td>
<td>datetime</td>
<td>Date until the document should be confirmed</td>
</tr>
<tr>
<td>document.first_reminder.days_before_deadline</td>
<td>integer</td>
<td>Number of days before the deadline the first reminder should be sent</td>
</tr>
<tr>
<td>document.second_reminder.days_before_deadline</td>
<td>integer</td>
<td>Number of days before the deadline the second reminder should be sent</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>document</td>
<td>Document</td>
<td>See: <a href="#operations-admin-document-model">Document model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<h4 id="specific-validation-errors">Specific validation errors</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Error</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">document.first_reminder</code></td>
<td><code class="prettyprint">already_sent</code></td>
</tr>
<tr>
<td><code class="prettyprint">document.second_reminder</code></td>
<td><code class="prettyprint">already_sent</code></td>
</tr>
<tr>
<td><code class="prettyprint">document.second_reminder</code></td>
<td><code class="prettyprint">cannot_be_present_without_first_reminder</code></td>
</tr>
<tr>
<td><code class="prettyprint">document.second_reminder.days_before_deadline</code></td>
<td><code class="prettyprint">cannot_be_before_first_reminder</code></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:Update</code> permit
</aside>

<h3 id="add-recipients-to-the-document"><a name="operations-admin-add-document-recipients"></a> Add recipients to the Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/12"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
        "recipients": [4, 2, 42]
    }
  '</span>
</code></pre>
<blockquote>
<p>Returns object containing created <a href="#operations-admin-document-recipient-model">document recipients</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document_recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">document</span><span class="w"> </span><span class="err">recipients</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"DocumentRecipient model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v1/operations/documents/:id</code></p>

<p>Adds <a href="#operations-admin-document-recipient-model">recipients</a> to the <a href="#operations-admin-document-model">Document</a> and sends them a notification.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>recipients</strong></td>
<td>integer[]</td>
<td>IDs of members that should receive the document - max. 1000</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:DocumentRecipients:Create</code> permit
</aside>

<h3 id="destroy-document"><a name="operations-admin-destroy-document"></a> Destroy Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/12 </span><span class="se">\</span><span class="s2">
  -H 'content-type: application/json' </span><span class="se">\</span><span class="s2">
  -H 'x-loyalty-club-slug: infinity-mall' </span><span class="se">\</span><span class="s2">
  -H 'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM' </span><span class="se">\</span><span class="s2">
  -H 'x-product-name: default' </span><span class="se">\</span><span class="s2">
  -H 'x-user-agent: CURL manual test'
</span></code></pre>
<blockquote>
<p>When successful, returns object containing destroyed <a href="#operations-admin-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Document</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v1/operations/documents/:id</code></p>

<p>Destroys the <a href="#operations-admin-document-model">Document</a>.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>document</td>
<td>Document</td>
<td>See: <a href="#operations-admin-document-model">Document model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:Destroy</code> permit
</aside>
