<h1 id="files-api">Files API</h1>

<h2 id="introduction">Introduction</h2>

<h3 id="file-model"><a name="file-model"></a> File model</h3>

<p>Every file attached to some entity (Offer, Reward, Offer Collection) follows the file schema and is defined like this:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>URL</td>
<td>Link to the file</td>
</tr>
<tr>
<td>width</td>
<td>integer</td>
<td>Image width</td>
</tr>
<tr>
<td>height</td>
<td>integer</td>
<td>Image height</td>
</tr>
<tr>
<td>kind</td>
<td>string</td>
<td>File kind identifier (e.x. <code class="prettyprint">offer_default</code>), see <a href="#file-kinds">Standard file kinds</a></td>
</tr>
<tr>
<td>size_type</td>
<td>string</td>
<td>e.x. <code class="prettyprint">base</code>, see: <a href="#file-sizes">File sizes</a></td>
</tr>
</tbody></table>

<h3 id="file-schema"><a name="file-schema"></a> File schema</h3>

<p>File schema defines a list of files kinds available in the Loyalty club. 
Each file kind is also available in multiple sizes. </p>

<p>The schema may get retrieved with <a href="#get-file-schema">Files&bull; Get schema</a> endpoint.</p>

<blockquote>
<p>Example loyalty club file schema</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"files_kinds"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"collection_cover_default"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ratio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2:1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"offer_default"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ratio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3:4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reward_default"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ratio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3:4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example_without_ratio"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ratio"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="file-kind-model"><a name="file-kind-model"></a> File kind model</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>identifier</td>
<td>string</td>
<td>See: <a href="#file-kinds">Standard file kinds</a></td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>Currently, only <code class="prettyprint">IMAGE</code> (MIME: <code class="prettyprint">image/gif</code>, <code class="prettyprint">image/jpeg</code>, <code class="prettyprint">image/png</code>) is supported</td>
</tr>
<tr>
<td>ratio</td>
<td>string</td>
<td>Describes ratio of an image. See: <a href="#file-kind-ratio">Ratio</a> (optional)</td>
</tr>
<tr>
<td>sizes</td>
<td>Array<Object></td>
<td>See: <a href="#file-sizes">File sizes</a></td>
</tr>
<tr>
<td>sizes[][&lsquo;identifier&rsquo;]</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>sizes[][&lsquo;min_width&rsquo;]</td>
<td>integer</td>
<td>(optional)</td>
</tr>
<tr>
<td>sizes[][&lsquo;min_height&rsquo;]</td>
<td>integer</td>
<td>(optional)</td>
</tr>
<tr>
<td>sizes[][&lsquo;max_width&rsquo;]</td>
<td>integer</td>
<td>(optional)</td>
</tr>
<tr>
<td>sizes[][&lsquo;max_height&rsquo;]</td>
<td>integer</td>
<td>(optional)</td>
</tr>
</tbody></table>

<h3 id="standard-file-kinds"><a name="file-kinds"></a> Standard file kinds</h3>

<p>There are some standard file kinds, their size definitions differ among Loyalty Clubs.</p>

<table><thead>
<tr>
<th>Identifier</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">collection_cover_default</code></td>
<td>Cover for Offer collections</td>
</tr>
<tr>
<td><code class="prettyprint">offer_default</code></td>
<td>Default Offer image</td>
</tr>
<tr>
<td><code class="prettyprint">reward_default</code></td>
<td>Default Reward image</td>
</tr>
</tbody></table>

<h3 id="ratio"><a name="file-kind-ratio"></a> Ratio</h3>

<p>Images may have fixed proportions ratio which is represented as a string: <code class="prettyprint">&quot;&lt;width&gt;:&lt;height&gt;&quot;</code></p>

<h3 id="file-sizes"><a name="file-sizes"></a> File sizes</h3>

<p>Every file has at least three file sizes available: </p>

<h4 id="base"><code class="prettyprint">base</code></h4>

<p>Actual file size. Currently all file kinds have this size with fixed proportions (so <code class="prettyprint">min_*</code> == <code class="prettyprint">max_*</code>) that match the ratio.</p>

<h4 id="thumbnail"><code class="prettyprint">thumbnail</code></h4>

<p>Rescaled version of <code class="prettyprint">base</code> size. Currently, rescaling always works this way:</p>

<ul>
<li>pick the higher dimension of file</li>
<li>shrink the image so:

<ul>
<li>the higher dimension gets shrunk to <code class="prettyprint">300px</code></li>
<li>the lower dimensions gets shrunk so the image keeps the original ratio</li>
</ul></li>
</ul>

<p>Examples:</p>

<ul>
<li>File with resolution <code class="prettyprint">600x800</code> gets shrunk down to <code class="prettyprint">225x300</code></li>
<li>File with resolution <code class="prettyprint">800x600</code> gets shrunk down to <code class="prettyprint">300x225</code></li>
<li>File with resolution <code class="prettyprint">400x300</code> gets shrunk down to <code class="prettyprint">300x225</code></li>
<li>File with resolution <code class="prettyprint">400x200</code> gets shrunk down to <code class="prettyprint">300x150</code></li>
<li>File with resolution <code class="prettyprint">300x250</code> is not shrunk down</li>
</ul>

<h4 id="original"><code class="prettyprint">original</code></h4>

<p>Original file that that has been uploaded and used for generating other file sizes.</p>

<p>Currently, we require all original files to have proper ratios and minimum sizes of at least the <code class="prettyprint">base</code> size.
Because of that, you can expect them to have <code class="prettyprint">min_height</code> and <code class="prettyprint">min_width</code> that match the <code class="prettyprint">base</code> size, 
but they never have <code class="prettyprint">max_width</code> or <code class="prettyprint">max_height</code> defined.</p>

<h4 id="file-cropping"><a name="file-cropping"></a> File cropping</h4>

<blockquote>
<p><code class="prettyprint">crop_to</code> param interpretation may be visualized like this:</p>
</blockquote>
<pre class="highlight plaintext"><code>
                           x_top_left     x_bottom_right
                    |-------------------------------------
                    | ..........................
                    | ..........................
     y_top_left     | .....*---------------.....
                    | .....|..............|.....
                    | .....|..............|.....
                    | .....|..............|....
     y_bottom_right | .....---------------*.....
                    | ..........................
                    |

</code></pre>
<p>When file is uploaded and it&rsquo;s too large to match the required base size, it may get cropped.
This can be achieved by providing cropping param (<code class="prettyprint">crop_to</code>).</p>

<p>The param has following syntax: <code class="prettyprint">x_top_left,y_top_left,x_bottom_right,y_bottom_right</code> and represents boundaries of a cropping area. </p>

<p>When uploaded file is too large and <code class="prettyprint">crop_to</code> param is not provided, the file will be automatically cropped with gravity set in center of image.</p>

<h5 id="example">Example</h5>

<p>The kind&rsquo;s base size is 400x200px and the uploaded file is 1000x1000px. </p>

<p>With crop_to=&ldquo;0,250,1000,750&rdquo;, a rectangle of &ldquo;1000x500&rdquo; size will be cropped, with 250px left offset.
The file will be then also resized to 400x200.</p>

<h4 id="uploaded-instances-projections"><a name="projected-file-versions"></a> Uploaded instances projections</h4>

<p>When file is uploaded, only original file is physically processed and stored. <code class="prettyprint">base</code> and other versions are processed asynchronously. 
So, the responses returned on upload contains only &ldquo;projected&rdquo; info about files.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>size_type</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>url</td>
<td>string</td>
<td>An URL the file be available on <strong>after</strong> it gets processed.</td>
</tr>
<tr>
<td>min_width</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>max_width</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>min_height</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>max_height</td>
<td>integer</td>
<td></td>
</tr>
</tbody></table>

<h2 id="files">Files</h2>

<h3 id="get-file-schema"><a name="get-file-schema"></a> Get file schema</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://bpc-api.boostcom.no/v3/infinity-mall/files/schema"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns the schema as described <a href="#file-schema">here</a></p>
</blockquote>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/schema</code></p>

<p>Returns the Loyalty Club file schema. See: <a href="#file-schema">Files &bull; Schema</a></p>

<aside class="notice">
Requires <code>Files:Api:GetSchema</code> permit
</aside>

<h3 id="create-file"><a name="create-file"></a> Create file</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
  https://bpc-api.boostcom.no/v3/infinity-mall/files/offers/1000289/offer_default <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -H <span class="s1">'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW'</span> <span class="se">\</span>
  -F <span class="nv">file</span><span class="o">=</span>@some_file.png <span class="se">\</span>
  -F <span class="s1">'crop_to=256,256,856,1056'</span>

</code></pre>
<blockquote>
<p>Returns info about uploaded file and it&rsquo;s projected versions</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"original"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000289-offer_default-original.png"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"file_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span><span class="w">
        </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span><span class="w">
        </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"offer_default"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"projected_versions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000289-offer_default-base.png"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
            </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
            </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
            </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000289-offer_default-thumbnail.png"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
            </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
            </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
            </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/:fileable_type/:fileable_id/kind</code></p>

<p>Creates new file for given Fileable (e.g. Offer).</p>

<h4 id="url-parameters"><a name="create-file-url-parameters"></a> URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>fileable_type</td>
<td>enum: <code class="prettyprint">[&#39;offers&#39;, &#39;collections&#39;]</code></td>
<td></td>
</tr>
<tr>
<td>fileable_id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>kind</td>
<td>enum</td>
<td>see <a href="#file-kinds">Standard file kinds</a></td>
</tr>
</tbody></table>

<h4 id="post-parameters"><a name="create-file-post-parameters"></a> POST Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>file</td>
<td>binary</td>
<td>yes</td>
<td>File to upload</td>
</tr>
<tr>
<td>crop_to</td>
<td>string</td>
<td>no</td>
<td>See: <a href="#file-cropping">cropping</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object"><a name="create-file-response"></a> Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>original</td>
<td>File</td>
<td>See <a href="#file-model">File model</a></td>
</tr>
<tr>
<td>projected_versions</td>
<td>ProjectedVersion[]</td>
<td>See <a href="#projected-file-versions">Projected file versions</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>The Fileable does not exist</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Files:Api:Create</code> permit
</aside>

<h3 id="update-file"><a name="update-file"></a> Update file</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
  https://bpc-api.boostcom.no/v3/infinity-mall/files/offers/1000289/offer_default <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -H <span class="s1">'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW'</span> <span class="se">\</span>
  -F <span class="nv">file</span><span class="o">=</span>@some_file.png <span class="se">\</span>
  -F <span class="s1">'crop_to=256,256,856,1056'</span>

</code></pre>
<blockquote>
<p>When successful (200), Returns info about uploaded file. Same as <a href="#create-file">Create file</a> example response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Create file"</span><span class="w"> </span><span class="err">example</span><span class="w"> </span><span class="err">response</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/:fileable_type/:fileable_id/kind</code></p>

<p>Updates file for given Fileable (e.g. Offer).</p>

<h4 id="url-parameters">URL Parameters</h4>

<p>See: <a href="#create-file-url-parameters">Create File URL Parameters</a></p>

<h4 id="post-parameters">POST Parameters</h4>

<p>See: <a href="#create-file-post-parameters">Create File POST Parameters</a></p>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>See: <a href="#create-file-response">Create File Response</a></p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Fileable not found</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>File not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Files:Api:Update</code> permit
</aside>

<h3 id="reprocess-file"><a name="reprocess-file"></a> Reprocess file</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
  https://bpc-api.boostcom.no/v3/infinity-mall/files/offers/1000289/offer_default/reprocess <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -H <span class="s1">'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW'</span> <span class="se">\</span>
  -F <span class="s1">'crop_to=256,256,856,1056'</span>

</code></pre>
<blockquote>
<p>When successful (200), Returns info about uploaded file. Same as <a href="#create-file">Create file</a> example response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Create file"</span><span class="w"> </span><span class="err">example</span><span class="w"> </span><span class="err">response</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/:fileable_type/:fileable_id/kind/reprocess</code></p>

<p>Reprocesses file for given Fileable (e.g. Offer).
It means that no file needs to be uploaded, instead the original file will be reprocessed according to given parameters. </p>

<h4 id="url-parameters">URL Parameters</h4>

<p>See: <a href="#create-file-url-parameters">Create File URL Parameters</a></p>

<h4 id="post-parameters">POST Parameters</h4>

<p>See: <a href="#create-file-post-parameters">Create File POST Parameters</a> - except no <code class="prettyprint">file</code> param is accepted here</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>See: <a href="#create-file-response">Create File Response</a></p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Fileable not found</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>File not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Files:Api:Reprocess</code> permit
</aside>

<h3 id="delete-file"><a name="delete-file"></a> Delete file</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="s2">"https://bpc-api.boostcom.no/v3/infinity-mall/files/offers/1000289/offer_default </span><span class="se">\</span><span class="s2">
  -H 'content-type: application/json' </span><span class="se">\</span><span class="s2">
  -H 'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM' </span><span class="se">\</span><span class="s2">
  -H 'x-product-name: default' </span><span class="se">\</span><span class="s2">
  -H 'x-user-agent: CURL manual test'
</span></code></pre>
<blockquote>
<p>When successful (200), returns an empty object</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/:fileable_type/:fileable_id/kind</code></p>

<p>Deletes file of given Fileable (e.g. Offer).</p>

<h4 id="url-parameters">URL Parameters</h4>

<p>See: <a href="#create-file-url-parameters">Create File URL Parameters</a></p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Fileable not found</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>File not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Files:Api:Delete</code> permit
</aside>
